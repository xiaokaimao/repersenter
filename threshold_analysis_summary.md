# Shapley值贡献分析和阈值优化报告

## 总结

本分析基于ResNet18在CIFAR-10数据集上的Shapley值数据，针对10%标签噪声的情况进行了深入分析。

## 主要发现

### 1. 数据基本情况
- **总样本数**: 50,000
- **翻转样本数**: 5,000 (10.00%)
- **正确样本数**: 45,000 (90.00%)

### 2. 贡献值分布分析

#### 整体统计
- **整体平均值**: 1574.62
- **整体标准差**: 2154.30
- **整体范围**: [-6519.94, 8903.65]

#### 分组统计
- **翻转样本贡献值**:
  - 平均值: -1444.40 (负值，符合理论预期)
  - 标准差: 1502.77
  - 范围: [-6519.94, 2004.80]

- **正确样本贡献值**:
  - 平均值: 1910.06 (正值，符合理论预期)
  - 标准差: 1944.35
  - 范围: [3.88, 8903.65]

### 3. 意外情况分析

#### 翻转样本中的意外情况
- **贡献值 >= 0 的数量**: 1,058个
- **占翻转样本比例**: 21.16%
- **分析**: 约1/5的翻转样本对其原始标签仍有正贡献，这可能是由于：
  - 数据本身具有一定的噪声抗性
  - 模型对这些样本的学习程度不足
  - 这些样本可能是"困难样本"而非真正的噪声

#### 正确样本中的意外情况
- **贡献值 < 0 的数量**: 0个
- **占正确样本比例**: 0.00%
- **分析**: 所有正确样本都对其原始标签有正贡献，这是一个非常好的结果

### 4. 阈值优化结果

#### 最佳阈值
- **最佳阈值**: 4.818
- **最佳F1分数**: 0.8825
- **对应精确率**: 0.9997
- **对应召回率**: 0.7898

#### 阈值比较
| 阈值 | 检测数量 | 检测率 | 精确率 | 召回率 | F1分数 |
|------|----------|--------|--------|--------|--------|
| 0.000 | 3,942 | 7.88% | 1.0000 | 0.7884 | 0.8817 |
| 4.818 | 3,949 | 7.90% | 0.9997 | 0.7896 | 0.8825 |

### 5. 性能评估

#### 使用阈值 = 0.0 的结果
- **真正例(TP)**: 3,942 (正确检测的翻转样本)
- **假正例(FP)**: 0 (错误检测的正确样本)
- **假负例(FN)**: 1,058 (遗漏的翻转样本)
- **真负例(TN)**: 45,000 (正确识别的正确样本)

#### 使用最佳阈值 = 4.818 的结果
- **真正例(TP)**: 3,948 (正确检测的翻转样本)
- **假正例(FP)**: 1 (错误检测的正确样本)
- **假负例(FN)**: 1,052 (遗漏的翻转样本)
- **真负例(TN)**: 44,999 (正确识别的正确样本)

## 结论和建议

### 主要结论
1. **理论验证通过**: 翻转样本的平均贡献值(-1444.40)明显低于正确样本(1910.06)
2. **检测性能优秀**: F1分数达到0.88+，精确率接近100%
3. **阈值稳定**: 阈值=0和最佳阈值=4.818的性能相近，说明方法稳定

### 实际应用建议
1. **推荐阈值**: 使用0.0作为检测阈值，简单且效果好
2. **检测策略**: 对贡献值<0的样本进行人工审核
3. **质量控制**: 定期使用此方法检测数据质量

### 需要注意的问题
1. **21.16%的翻转样本**仍有正贡献，需要进一步分析原因
2. **遗漏率约21%**，可能需要结合其他方法提高召回率
3. **模型依赖性**: 结果依赖于特定的模型和数据集

### 后续工作建议
1. 分析正贡献翻转样本的特征
2. 尝试不同的阈值优化策略
3. 结合多种检测方法提高整体性能
4. 在其他数据集上验证方法的泛化能力

---

*报告生成时间: 2025-07-03*
*数据来源: ResNet18 on CIFAR-10 with 10% label noise*
*分析脚本: analyze_threshold.py*